"use strict";(self["webpackChunkandago_client"]=self["webpackChunkandago_client"]||[]).push([[273],{2273:(e,l,i)=>{i.r(l),i.d(l,{default:()=>w});i(7658);var a=i(6252),t=i(2262),u=i(6751),n=i(8903),d=i(9263),r=i(411),o=i(3577),c=i(6592);const p=(0,a._)("div",{id:"map2"},null,-1),U=(0,a.aZ)({__name:"ReceivedTripModal",props:{isOpen:Boolean,receivedTrip:{type:Object,required:!0}},emits:["update:isOpen","accept","update:receivedTrip"],setup(e,{emit:l}){const i=e,r=(0,d.h)(),U=(0,t.iH)(null);function s(){l("update:isOpen",!1)}function m(){l("update:isOpen",!1),r.axios.post("/drivers/trips/acceptTrip",{trip_id:i.receivedTrip.id}).then((e=>{const l=e.data;r.showToast({message:l.message,duration:2e3,position:"middle"}),"success"===l.status&&(r.acceptedTrip=l.trip)})).catch((e=>{console.log(e)}))}return(0,a.YP)((()=>i.isOpen),(async e=>{if(e){const e=await r.getGeolocation();c.Z.load().then((l=>{U.value=new l.Map(document.getElementById("map2"),{center:e,zoom:5,disableDefaultUI:!0}),c.Z.calculateRoute(e,i.receivedTrip.pickup_place,U.value)}))}})),(l,i)=>((0,a.wg)(),(0,a.j4)((0,t.SU)(u.ki),{"is-open":e.isOpen},{default:(0,a.w5)((()=>[(0,a.Wm)((0,t.SU)(u.Gu),null,{default:(0,a.w5)((()=>[(0,a.Wm)((0,t.SU)(u.sr),null,{default:(0,a.w5)((()=>[(0,a.Wm)((0,t.SU)(u.wd),null,{default:(0,a.w5)((()=>[(0,a.Uk)("Job Found")])),_:1})])),_:1})])),_:1}),(0,a.Wm)((0,t.SU)(u.W2),null,{default:(0,a.w5)((()=>[p,(0,a.Wm)((0,t.SU)(u.q_),null,{default:(0,a.w5)((()=>[(0,a.Wm)((0,t.SU)(u.Ie),null,{default:(0,a.w5)((()=>[(0,a.Wm)((0,t.SU)(u.Q$),null,{default:(0,a.w5)((()=>[(0,a.Uk)("Pick-Up")])),_:1}),(0,a.Wm)((0,t.SU)(u.yW),null,{default:(0,a.w5)((()=>[(0,a._)("h3",null,[(0,a.Wm)((0,t.SU)(u.gu),{icon:(0,t.SU)(n.xhW),color:"primary"},null,8,["icon"]),(0,a.Uk)((0,o.zw)(e.receivedTrip.pickup_place.name),1)]),(0,a._)("p",null,(0,o.zw)(e.receivedTrip.pickup_place.address),1)])),_:1})])),_:1}),(0,a.Wm)((0,t.SU)(u.Ie),null,{default:(0,a.w5)((()=>[(0,a.Wm)((0,t.SU)(u.Q$),null,{default:(0,a.w5)((()=>[(0,a.Uk)("Drop-Off")])),_:1}),(0,a.Wm)((0,t.SU)(u.yW),null,{default:(0,a.w5)((()=>[(0,a._)("h3",null,[(0,a.Wm)((0,t.SU)(u.gu),{icon:(0,t.SU)(n.c4g),color:"tertiary"},null,8,["icon"]),(0,a.Uk)((0,o.zw)(e.receivedTrip.dropoff_place.name),1)]),(0,a._)("p",null,(0,o.zw)(e.receivedTrip.dropoff_place.address),1)])),_:1})])),_:1}),(0,a.Wm)((0,t.SU)(u.Ie),null,{default:(0,a.w5)((()=>[(0,a.Wm)((0,t.SU)(u.Q$),null,{default:(0,a.w5)((()=>[(0,a.Uk)("Trip Distance:")])),_:1}),(0,a.Wm)((0,t.SU)(u.uN),{slot:"end"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.receivedTrip.distance)+" km",1)])),_:1})])),_:1}),(0,a.Wm)((0,t.SU)(u.Ie),null,{default:(0,a.w5)((()=>[(0,a.Wm)((0,t.SU)(u.Q$),null,{default:(0,a.w5)((()=>[(0,a.Uk)("Trip Duration:")])),_:1}),(0,a.Wm)((0,t.SU)(u.uN),{slot:"end"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.receivedTrip.duration)+" mins",1)])),_:1})])),_:1}),(0,a.Wm)((0,t.SU)(u.Ie),null,{default:(0,a.w5)((()=>[(0,a.Wm)((0,t.SU)(u.Q$),null,{default:(0,a.w5)((()=>[(0,a.Uk)("Fare:")])),_:1}),(0,a.Wm)((0,t.SU)(u.uN),{slot:"end"},{default:(0,a.w5)((()=>[(0,a.Uk)("RM "+(0,o.zw)(e.receivedTrip.fare),1)])),_:1})])),_:1})])),_:1}),(0,a.Wm)((0,t.SU)(u.jY),null,{default:(0,a.w5)((()=>[(0,a.Wm)((0,t.SU)(u.Nd),null,{default:(0,a.w5)((()=>[(0,a.Wm)((0,t.SU)(u.wI),null,{default:(0,a.w5)((()=>[(0,a.Wm)((0,t.SU)(u.YG),{color:"primary",expand:"block",onClick:m},{default:(0,a.w5)((()=>[(0,a.Uk)("Accept")])),_:1})])),_:1}),(0,a.Wm)((0,t.SU)(u.wI),null,{default:(0,a.w5)((()=>[(0,a.Wm)((0,t.SU)(u.YG),{color:"secondary",expand:"block",onClick:s},{default:(0,a.w5)((()=>[(0,a.Uk)("Decline")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["is-open"]))}}),s=U,m=s,f=(0,a.aZ)({__name:"DriverMain",setup(e){const l=(0,d.h)(),i=(0,t.iH)(!1),o=(0,t.iH)({}),c=(0,t.iH)([]);return l.echo.private(`DriverChannel-${l.profile.id}`).listen(".TripConfirmedEvent",(async e=>{i.value?c.value.push(e.trip):(o.value=e.trip,i.value=!0)})),(0,a.YP)((()=>i.value),(e=>{e||c.value.length>0&&setTimeout((()=>{o.value=c.value.shift(),i.value=!0}),500)})),l.echo.join("DriverChannel"),r.b.watchPosition({},((e,i)=>{const a={position:{lat:null===e||void 0===e?void 0:e.coords.latitude,lng:null===e||void 0===e?void 0:e.coords.longitude}};l.axios.post("/drivers/updatePosition",a).then((e=>{})).catch((e=>{console.log(e)}))})),(e,l)=>((0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)((0,t.SU)(u._i),null,{default:(0,a.w5)((()=>[(0,a.Wm)((0,t.SU)(u.UN),null,{default:(0,a.w5)((()=>[(0,a.Wm)((0,t.SU)(u.jP)),(0,a.Wm)((0,t.SU)(u.yq),{color:"primary",slot:"bottom"},{default:(0,a.w5)((()=>[(0,a.Wm)((0,t.SU)(u.ZU),{tab:"tab1",href:"/driver/profile"},{default:(0,a.w5)((()=>[(0,a.Wm)((0,t.SU)(u.gu),{"aria-hidden":"true",icon:(0,t.SU)(n.lBs)},null,8,["icon"]),(0,a.Wm)((0,t.SU)(u.Q$),null,{default:(0,a.w5)((()=>[(0,a.Uk)("Profile")])),_:1})])),_:1}),(0,a.Wm)((0,t.SU)(u.ZU),{tab:"tab2",href:"/driver/trip"},{default:(0,a.w5)((()=>[(0,a.Wm)((0,t.SU)(u.gu),{"aria-hidden":"true",icon:(0,t.SU)(n.ZBl)},null,8,["icon"]),(0,a.Wm)((0,t.SU)(u.Q$),null,{default:(0,a.w5)((()=>[(0,a.Uk)("Job")])),_:1})])),_:1}),(0,a.Wm)((0,t.SU)(u.ZU),{tab:"tab3",href:"/driver/chat"},{default:(0,a.w5)((()=>[(0,a.Wm)((0,t.SU)(u.gu),{"aria-hidden":"true",icon:(0,t.SU)(n.WiS)},null,8,["icon"]),(0,a.Wm)((0,t.SU)(u.Q$),null,{default:(0,a.w5)((()=>[(0,a.Uk)("Chat")])),_:1})])),_:1}),(0,a.Wm)((0,t.SU)(u.ZU),{tab:"tab4",href:"/driver/settings"},{default:(0,a.w5)((()=>[(0,a.Wm)((0,t.SU)(u.gu),{"aria-hidden":"true",icon:(0,t.SU)(n.Xdb)},null,8,["icon"]),(0,a.Wm)((0,t.SU)(u.Q$),null,{default:(0,a.w5)((()=>[(0,a.Uk)("Settings")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.Wm)(m,{isOpen:i.value,"onUpdate:isOpen":l[0]||(l[0]=e=>i.value=e),"received-trip":o.value,"onUpdate:receivedTrip":l[1]||(l[1]=e=>o.value=e)},null,8,["isOpen","received-trip"])],64))}}),_=f,w=_}}]);
//# sourceMappingURL=273.7d1bba49.js.map